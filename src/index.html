<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    </head>
    <body>
        <style>
            #canvas {                                                                                                                                                                         
                height: 100%;
                overflow: hidden;
                display: block;
                position: absolute;
                top: 50%; left: 50%;
                transform: translate(-50%, -50%);
                margin: auto;
                aspect-ratio: 16 / 10;
            }
            #footer {
                background-color: black;
                color: white;
                position: absolute;
                margin: 0;
                left: 0;
                bottom: 0;
            }
        </style>
        <canvas id="canvas"></canvas>
        <script type='text/javascript'>
            var pointer_unlocked = null;
            var pointer_locked = null;

            var Module = {
                canvas: (function() { return document.getElementById('canvas'); })()
            };
            document.addEventListener("pointerlockchange", lockChangeAlert, false);

            function lockChangeAlert() {
                if (document.pointerLockElement === Module.canvas) {
                    if (pointer_locked != null) {
                        pointer_locked();
                    }
                } else {
                    if (pointer_unlocked != null) {
                        pointer_unlocked();
                    }
                }
            }

            function open_link(link) {
                window.open(UTF8ToString(link));
            }

            Module['onRuntimeInitialized'] = async () => {
                console.log("wasm loaded ");
                pointer_unlocked = Module.cwrap('pointer_unlocked', 'void', ['void'])
                pointer_locked = Module.cwrap('pointer_locked', 'void', ['void'])
                if (pointer_unlocked != null) {
                    pointer_unlocked();
                }

                await Module.canvas.requestPointerLock({
                    unadjustedMovement: true,
                });
            }

            Module.canvas.addEventListener("click", async () => {
                await Module.canvas.requestPointerLock({
                    unadjustedMovement: true,
                });
            });

        </script>
        <script src="index.js"></script>
    </body>
</html>